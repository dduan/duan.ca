<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
    <channel>
        <title>Daniel Duan's Articles About API Design Guidelines</title>
        <link>https://duan.ca/tag/api-design-guidelines/</link>
        <atom:link href="https://duan.ca/tag/api-design-guidelines/feed.xml" rel="self" type="application/rss+xml" />
            <item>
                <title>How To Omit Needless Words</title>
                <description>&lt;p&gt;A typical experience in adopting Swift 3 may look like this:&lt;&#x2f;p&gt;
&lt;ul&gt;
&lt;li&gt;Run the migrator.&lt;&#x2f;li&gt;
&lt;li&gt;Fix up what the migrator left undone so your project complies.&lt;&#x2f;li&gt;
&lt;li&gt;Remove artifacts that migrator added to ensure successful compilation (you
know what this means if you finished previous step in a mildly sized code
base).&lt;&#x2f;li&gt;
&lt;li&gt;Fix bugs caused by mechanical changes.&lt;&#x2f;li&gt;
&lt;li&gt;Try to adapt your code base to the new style: lowercased static members, etc.&lt;&#x2f;li&gt;
&lt;&#x2f;ul&gt;
&lt;p&gt;The last step is particularly challenging in a team environment because it
involves naming things. Luckily we have (IMHO) the best &amp;quot;features&amp;quot; in Swift
3 for help: the &lt;a href=&quot;https:&#x2f;&#x2f;swift.org&#x2f;documentation&#x2f;api-design-guidelines&#x2f;&quot;&gt;API Design Guidelines&lt;&#x2f;a&gt;.&lt;&#x2f;p&gt;
&lt;hr &#x2f;&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2f;&#x2f;swift.org&#x2f;documentation&#x2f;api-design-guidelines&#x2f;#omit-needless-words&quot;&gt;Omit needless words&lt;&#x2f;a&gt; is one of the most differentiating
guideline for function names between Swift 2 and 3. In Swift 2 we used to name
things like soâ€¦&lt;&#x2f;p&gt;
&lt;pre&gt;&lt;code&gt;func doStuffWithThing(thing: Thing) { â€¦ }
&lt;&#x2f;code&gt;&lt;&#x2f;pre&gt;
&lt;p&gt;â€¦ and use it like â€¦&lt;&#x2f;p&gt;
&lt;pre&gt;&lt;code&gt;doStuffWithThing(someThing)
&lt;&#x2f;code&gt;&lt;&#x2f;pre&gt;
&lt;p&gt;That&#x27;s a lot of &amp;quot;thing&amp;quot;s, have you noticed?&lt;&#x2f;p&gt;
&lt;p&gt;Since the word &amp;quot;Thing&amp;quot; is &lt;em&gt;merely repeating&lt;&#x2f;em&gt; the type information, we can omit
it in Swift 3:&lt;&#x2f;p&gt;
&lt;pre&gt;&lt;code&gt;&#x2f;&#x2f; declare
func doStuff(with thing: Thing) { â€¦ }

&#x2f;&#x2f; use
doStuff(with: someThing)
&lt;&#x2f;code&gt;&lt;&#x2f;pre&gt;
&lt;p&gt;It&#x27;s clear at both declaration and use site what we are doing stuff to.&lt;&#x2f;p&gt;
&lt;p&gt;So â€¦ you should go through you code base and make this change! In the next
section, we&#x27;ll discuss one way to make it happen.&lt;&#x2f;p&gt;
&lt;hr &#x2f;&gt;
&lt;h2&gt;Step 1: Automate&lt;&#x2f;h2&gt;
&lt;p&gt;A good indicator of &amp;quot;merely repeating type information&amp;quot; is repetition of words.
If you have been disciplined about naming your functions in Swift 2, finding
such repetition should take no more than one or two good regular expressions.
After the migrator, your code may contain a mixture of these:&lt;&#x2f;p&gt;
&lt;pre&gt;&lt;span class=&quot;source swift&quot;&gt;&lt;span class=&quot;meta function&quot;&gt;&lt;span class=&quot;meta toc-list&quot;&gt;&lt;span class=&quot;storage type function&quot;&gt;func&lt;&#x2f;span&gt; &lt;span class=&quot;entity name function&quot;&gt;&lt;span class=&quot;variable function&quot;&gt;doStuffWithX&lt;&#x2f;span&gt;&lt;&#x2f;span&gt;(&lt;span class=&quot;constant language other&quot;&gt;_&lt;&#x2f;span&gt;: &lt;span class=&quot;support class&quot;&gt;X&lt;&#x2f;span&gt;)&lt;&#x2f;span&gt;&lt;&#x2f;span&gt; { â€¦ }
&lt;span class=&quot;meta function&quot;&gt;&lt;span class=&quot;meta toc-list&quot;&gt;&lt;span class=&quot;storage type function&quot;&gt;func&lt;&#x2f;span&gt; &lt;span class=&quot;entity name function&quot;&gt;&lt;span class=&quot;variable function&quot;&gt;doStuff&lt;&#x2f;span&gt;&lt;&#x2f;span&gt;(forY &lt;span class=&quot;variable parameter&quot;&gt;y&lt;&#x2f;span&gt;: &lt;span class=&quot;support class&quot;&gt;Y&lt;&#x2f;span&gt;)&lt;&#x2f;span&gt;&lt;&#x2f;span&gt; { â€¦ }
&lt;&#x2f;span&gt;&lt;&#x2f;pre&gt;
&lt;p&gt;In other words, the repeating word (&lt;code&gt;X&lt;&#x2f;code&gt; or &lt;code&gt;Y&lt;&#x2f;code&gt;) is preceded by a
&lt;a href=&quot;https:&#x2f;&#x2f;www.englishclub.com&#x2f;grammar&#x2f;prepositions-list.htm&quot;&gt;preposition&lt;&#x2f;a&gt;.&lt;&#x2f;p&gt;
&lt;p&gt;Finding these in a large code base is quite fun. If you don&#x27;t feel like writing
the scripts yourself, I&#x27;ve made a little tool for it &lt;a href=&quot;https:&#x2f;&#x2f;github.com&#x2f;dduan&#x2f;needless&quot;&gt;here&lt;&#x2f;a&gt;.&lt;&#x2f;p&gt;
&lt;p&gt;(Sometimes the repeating words aren&#x27;t a exact match because of prefixes such as
&amp;quot;CG&amp;quot; in &lt;code&gt;CGSize&lt;&#x2f;code&gt;. That&#x27;s covered by the tool as well.)&lt;&#x2f;p&gt;
&lt;h2&gt;Step 2: Update&lt;&#x2f;h2&gt;
&lt;p&gt;You can further rearrange the pieces in function name mechanically to:&lt;&#x2f;p&gt;
&lt;pre&gt;&lt;span class=&quot;source swift&quot;&gt;&lt;span class=&quot;meta function&quot;&gt;&lt;span class=&quot;meta toc-list&quot;&gt;&lt;span class=&quot;storage type function&quot;&gt;func&lt;&#x2f;span&gt; &lt;span class=&quot;entity name function&quot;&gt;&lt;span class=&quot;variable function&quot;&gt;doStuff&lt;&#x2f;span&gt;&lt;&#x2f;span&gt;(preposition &lt;span class=&quot;variable parameter&quot;&gt;originalArgName&lt;&#x2f;span&gt;: &lt;span class=&quot;support class&quot;&gt;Type&lt;&#x2f;span&gt;)&lt;&#x2f;span&gt;&lt;&#x2f;span&gt; { â€¦ }
&lt;&#x2f;span&gt;&lt;&#x2f;pre&gt;
&lt;p&gt;The &lt;a href=&quot;https:&#x2f;&#x2f;github.com&#x2f;dduan&#x2f;needless&quot;&gt;tool&lt;&#x2f;a&gt; I wrote can suggest alternatives like this. Applying them
is technically automatable. But I find manually doing tasks such as fixing up
indentation for multi-line functions or updating their use site to be easier.
Your conclusion may depend the size of your code base and your patience.&lt;&#x2f;p&gt;
&lt;h2&gt;Step 3: Audit&lt;&#x2f;h2&gt;
&lt;p&gt;The main goal for the API Design Guidelines is &amp;quot;clarity at the point of use&amp;quot;.
Our automated process will yield some undesirable results. I&#x27;ll list a few
scenarios here.&lt;&#x2f;p&gt;
&lt;p&gt;&lt;strong&gt;Poorly named function name becomes poorer&lt;&#x2f;strong&gt;. Example:
&lt;code&gt;alertForScreenSize(_ size CGRize)&lt;&#x2f;code&gt; becomes &lt;code&gt;alert(forScreen size: CGSize)&lt;&#x2f;code&gt;.
Obviously, &amp;quot;for screen&amp;quot; is misleading since a &lt;code&gt;CGSize&lt;&#x2f;code&gt; is not a screen. The
problem here is the &amp;quot;alert&amp;quot; is not for a &amp;quot;size&amp;quot; to begin with. We as human
intuitively pick up that it&#x27;s for a &amp;quot;screen with a certain size&amp;quot;. So the correct
renaming here should be &lt;code&gt;alertForScreen(with size: CGSize)&lt;&#x2f;code&gt;.&lt;&#x2f;p&gt;
&lt;p&gt;&lt;strong&gt;Awkward literal values results in ungrammatical phrases&lt;&#x2f;strong&gt;. Imagine our
argument is a enum:&lt;&#x2f;p&gt;
&lt;pre&gt;&lt;span class=&quot;source swift&quot;&gt;&lt;span class=&quot;entity name type&quot;&gt;&lt;span class=&quot;keyword entity&quot;&gt;enum&lt;&#x2f;span&gt; &lt;span class=&quot;entity name type&quot;&gt;&lt;span class=&quot;support class&quot;&gt;Mode&lt;&#x2f;span&gt;&lt;&#x2f;span&gt;&lt;&#x2f;span&gt; {
  &lt;span class=&quot;keyword control&quot;&gt;case&lt;&#x2f;span&gt; add
  &lt;span class=&quot;keyword control&quot;&gt;case&lt;&#x2f;span&gt; edit
}
&lt;&#x2f;span&gt;&lt;&#x2f;pre&gt;
&lt;p&gt;â€¦ and we renamed a function &lt;code&gt;updateUIForMode(mode: Mode)&lt;&#x2f;code&gt; to
&lt;code&gt;update(for mode: Mode)&lt;&#x2f;code&gt;. The call site, therefore, becomes
&lt;code&gt;update(for: .add)&lt;&#x2f;code&gt;.&lt;&#x2f;p&gt;
&lt;p&gt;What makes it feels wrong? Well, a preposition followed by a verb (&amp;quot;for add&amp;quot;)
is not very grammatical. Normally we would say &amp;quot;update UI for &lt;em&gt;adding&lt;&#x2f;em&gt;&amp;quot;. So here
we need to update the literals in that enum to &amp;quot;adding&amp;quot; and &amp;quot;editing&amp;quot;.&lt;&#x2f;p&gt;
&lt;p&gt;&lt;strong&gt;Type information becomes too weak&lt;&#x2f;strong&gt;. This can happen very often with enum
literals. We often name enum values with an adjective to qualify its name:&lt;&#x2f;p&gt;
&lt;pre&gt;&lt;span class=&quot;source swift&quot;&gt;&lt;span class=&quot;entity name type&quot;&gt;&lt;span class=&quot;keyword entity&quot;&gt;enum&lt;&#x2f;span&gt; &lt;span class=&quot;entity name type&quot;&gt;&lt;span class=&quot;support class&quot;&gt;UIControlState&lt;&#x2f;span&gt;&lt;&#x2f;span&gt;&lt;&#x2f;span&gt; {
    &lt;span class=&quot;keyword control&quot;&gt;case&lt;&#x2f;span&gt; automatic &lt;span class=&quot;comment line&quot;&gt;&lt;span class=&quot;punctuation definition comment&quot;&gt;&#x2f;&#x2f;&lt;&#x2f;span&gt; which state? the *automatic* state!&lt;&#x2f;span&gt;
    â€¦
}
&lt;&#x2f;span&gt;&lt;&#x2f;pre&gt;
&lt;p&gt;After renaming, we&#x27;ll have functions that simply becomes too generic and
mysterious at call site:&lt;&#x2f;p&gt;
&lt;pre&gt;&lt;span class=&quot;source swift&quot;&gt;update(&lt;span class=&quot;keyword control&quot;&gt;for&lt;&#x2f;span&gt;: .&lt;span class=&quot;constant language enum&quot;&gt;automatic&lt;&#x2f;span&gt;) &lt;span class=&quot;comment line&quot;&gt;&lt;span class=&quot;punctuation definition comment&quot;&gt;&#x2f;&#x2f;&lt;&#x2f;span&gt; automatic what? ðŸ˜‚&lt;&#x2f;span&gt;
&lt;&#x2f;span&gt;&lt;&#x2f;pre&gt;
&lt;p&gt;This is where we need to be flexible and use our own good judgement. Perhaps
it&#x27;s simply better to keep the qualifying postfix:&lt;&#x2f;p&gt;
&lt;pre&gt;&lt;span class=&quot;source swift&quot;&gt;update(&lt;span class=&quot;variable parameter&quot;&gt;forControlState&lt;&#x2f;span&gt;: .&lt;span class=&quot;constant language enum&quot;&gt;automatic&lt;&#x2f;span&gt;) &lt;span class=&quot;comment line&quot;&gt;&lt;span class=&quot;punctuation definition comment&quot;&gt;&#x2f;&#x2f;&lt;&#x2f;span&gt; better&lt;&#x2f;span&gt;
&lt;&#x2f;span&gt;&lt;&#x2f;pre&gt;
&lt;p&gt;In the guideline&#x27;s parlance, this is &lt;a href=&quot;https:&#x2f;&#x2f;swift.org&#x2f;documentation&#x2f;api-design-guidelines&#x2f;#weak-type-information&quot;&gt;compensate for weak type
information&lt;&#x2f;a&gt;.&lt;&#x2f;p&gt;
&lt;p&gt;&lt;strong&gt;Other argument labels needs updates too&lt;&#x2f;strong&gt;. A function at call site should read
like a sentence as much as possible. We removed words at beginning of the
&amp;quot;sentence&amp;quot;, it&#x27;s important to take a look at labels for the rest of the sentence
and ensure the whole thing fits together.&lt;&#x2f;p&gt;
&lt;hr &#x2f;&gt;
&lt;p&gt;There are &lt;em&gt;many&lt;&#x2f;em&gt;, &lt;em&gt;many&lt;&#x2f;em&gt; other fallouts from mechanically omitting needless
words that I didn&#x27;t cover in this post. There are many many other things in the
API Design Guidelines that are worth conforming to. There will be much much bike
shedding among your team members.&lt;&#x2f;p&gt;
&lt;p&gt;Just remember, the API guidelines don&#x27;t provide an answer to every naming
decision. Following it means your code base will fit in with the rest of the
community and APIs from Foundation&#x2f;Swift standard library. But find what feels
right for your team is the most important thing. In the end, you should be glad
that everyone cares so much about your code base&#x27;s &amp;quot;Swiftness&amp;quot; and it&#x27;ll be all
worth it!&lt;&#x2f;p&gt;
</description>
                <pubDate>Sat, 22 Oct 2016 17:08:41 -0700</pubDate>
                <link>https://duan.ca/2016/10/22/how-to-omit-needless-words/</link>
                <guid isPermaLink="true">https://duan.ca/2016/10/22/how-to-omit-needless-words/</guid>
            </item>
    </channel>
</rss>