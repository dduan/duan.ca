<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
    <channel>
        <title>Daniel Duan's Articles About Git</title>
        <link>https://duan.ca/tag/git/</link>
        <atom:link href="https://duan.ca/tag/git/feed.xml" rel="self" type="application/rss+xml" />
            <item>
                <title>Git Commit Message, Vim, and Markdown</title>
                <description>&#60;p&#62;It&#39;s been bothering me for years.&#60;/p&#62;
&#60;p&#62;That is, &#60;code&#62;#&#60;/code&#62; is both the start of a comment in a git commit message, but also
the syntax for headings in Markdown.&#60;/p&#62;
&#60;p&#62;Personally, I prefer using commit messages to populate pull request descriptions
whenever possible. On GitHub, This happens automatically when the pull request
contains a single commit. But I can&#39;t type, say an H3 as &#60;code&#62;### Heading&#60;/code&#62; in the
commit message (in Vim, most of the time) because it gets treated as a comment!&#60;/p&#62;
&#60;p&#62;But thanks to this twitter interaction with &#60;a href=&#34;https://twitter.com/dmartincy&#34;&#62;@dmartincy&#60;/a&#62;, I finally solved
this problem:&#60;/p&#62;
&#60;blockquote class=&#34;twitter-tweet&#34;&#62;&#60;p lang=&#34;en&#34; dir=&#34;ltr&#34;&#62;I haven&#38;#39;t found myself in that situation, but maybe you could do &#38;#39;git config core.commentChar &#38;quot;;&#38;quot;&#38;#39; before creating the commits? That will change the default git commit marker (#) to something that won&#38;#39;t conflict with Markdown titles.&#60;/p&#62;&#38;mdash; Daniel Martín (@dmartincy) &#60;a href=&#34;https://twitter.com/dmartincy/status/1247271508420026368?ref_src=twsrc%5Etfw&#34;&#62;April 6, 2020&#60;/a&#62;&#60;/blockquote&#62; &#60;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&#62;&#60;/script&#62;
&#60;p&#62;As mentioned by Daniel, Git has introduced a setting called &#60;code&#62;core.commentChar&#60;/code&#62;,
documented &#60;a href=&#34;https://git-scm.com/docs/git-config#Documentation/git-config.txt-corecommentChar&#34;&#62;here&#60;/a&#62;, which lets us control which character
becomes the start of a comment line. Let&#39;s say we want to replace the default
&#60;code&#62;#&#60;/code&#62; with &#60;code&#62;;&#60;/code&#62;, we can edit &#60;code&#62;~/.gitconfig&#60;/code&#62; to include this preference:&#60;/p&#62;
&#60;pre&#62;&#60;code&#62;[core]
	commentChar = &#38;quot;;&#38;quot;
&#60;/code&#62;&#60;/pre&#62;
&#60;p&#62;… and this will affect every Git repository on this computer.&#60;/p&#62;
&#60;p&#62;For me, though, this broke git commit syntax highlighting in Vim: the comments,
beginning with &#60;code&#62;;&#60;/code&#62;, are no longer recognized as comments. To fix this, I updated
Vim&#39;s syntax for file type &#60;code&#62;gitcommit&#60;/code&#62;. In your Vim setting directory
(&#60;code&#62;~/.config/nvim/&#60;/code&#62; for me), create a file &#60;code&#62;syntax/gitcommit.vim&#60;/code&#62; file (unless
you already have one), add the following line:&#60;/p&#62;
&#60;pre&#62;&#60;code&#62;syn match gitcommitComment	&#38;quot;^;.*&#38;quot;
&#60;/code&#62;&#60;/pre&#62;
&#60;p&#62;Note &#60;code&#62;;&#60;/code&#62; matches my preferred &#60;code&#62;core.commentChar&#60;/code&#62; for Git.&#60;/p&#62;
&#60;p&#62;Et voilà! Git commit message looks tippy-top in Vim again!&#60;/p&#62;
&#60;p&#62;&#60;img src=&#34;/assets/2020/04/gitcommit.png&#34; alt=&#34;editing git commit in vim, with alternative character being the beginning of a comment&#34; /&#62;&#60;/p&#62;
</description>
                <pubDate>Mon, 13 Apr 2020 13:41:02 -0700</pubDate>
                <link>https://duan.ca/2020/04/13/git-commit-comment/</link>
                <guid isPermaLink="true">https://duan.ca/2020/04/13/git-commit-comment/</guid>
            </item>
            <item>
                <title>Rebase And Sign Multiple Git Commits</title>
                <description>&#60;p&#62;I never bothered &#60;a href=&#34;https://git-scm.com/book/en/v2/Git-Tools-Signing-Your-Work&#34;&#62;signing&#60;/a&#62; my git commits until Github started putting
those shiny badges on them. Since then I&#39;ve encountered a problem: rebased
commits lose their hash and their signed-ness.&#60;/p&#62;
&#60;p&#62;That&#39;s not a big deal for a single commit. Just run &#60;code&#62;git commit -S --amend --no-edit&#60;/code&#62; after rebase. And that commit, which is at &#60;code&#62;HEAD&#60;/code&#62; will have a new
hash and be signed.&#60;/p&#62;
&#60;p&#62;What if we have more than one commit to rebase? My instinctive answer was sign
the one on &#60;code&#62;HEAD&#60;/code&#62;, then use interactive rebase to rotate the next one on top and
sign it, repeat until each one is signed and reorder them. But that doesn&#39;t work
at all because a commit&#39;s position in history is part of its content. That means
after a commit is rebased, it and every commits following it will have a new
hash and git doesn&#39;t give us an oppurtunity to say &#38;quot;include my signature,
please&#38;quot;. You cannot rebase and keep the commits signed!&#60;/p&#62;
&#60;p&#62;Well, that kind of sucks. But you are reading about it here, so I&#39;d better give
you something to help, right?&#60;/p&#62;
&#60;p&#62;There is, at least, one way to achieve &#60;em&#62;rebase and sign multiple commits&#60;/em&#62;:&#60;/p&#62;
&#60;ol&#62;
&#60;li&#62;Run interactive rebase: &#60;code&#62;git rebase -i branch&#60;/code&#62;.&#60;/li&#62;
&#60;li&#62;Mark all commits and &#38;quot;edit&#38;quot; or &#38;quot;e&#38;quot;.&#60;/li&#62;
&#60;li&#62;Git now stops at every commit for you to make changes. This is an oppurtunity
to sign it! &#60;code&#62;git commit -S --amend --no-edit&#60;/code&#62;, just like how you would sign
&#60;code&#62;HEAD&#60;/code&#62;.&#60;/li&#62;
&#60;li&#62;&#60;code&#62;git rebase --continue&#60;/code&#62;, move on the next commit until all every one is
edited.&#60;/li&#62;
&#60;/ol&#62;
&#60;p&#62;There&#39;s virtually nothing you cannot do with git. Hence the reputation for it&#39;s
glorious UI, ya know?&#60;/p&#62;
</description>
                <pubDate>Sat, 24 Dec 2016 01:31:14 -0800</pubDate>
                <link>https://duan.ca/2016/12/24/rebase-multiple-git-commits-with-signing/</link>
                <guid isPermaLink="true">https://duan.ca/2016/12/24/rebase-multiple-git-commits-with-signing/</guid>
            </item>
            <item>
                <title>Deploy Jekyll Site To Github With Make</title>
                <description>&#60;p&#62;At risks of being too meta, I want to talk about how this post is going to go
from my computer to a repository on Github on both the &#60;code&#62;master&#60;/code&#62; and &#60;code&#62;gh-pages&#60;/code&#62;
branch. The former contains the file I&#39;m typing, and the latter an updated
HTML site generated by Jekyll.&#60;/p&#62;
&#60;p&#62;Here&#39;s how: I type &#60;code&#62;make deploy&#60;/code&#62; once I commit this file in my local
repository.&#60;/p&#62;
&#60;p&#62;I spent a day to set up a Jekyll site. The last part involves deploying it to
Github, my preferred way to host a static site. There are a lot of posts and
scripts on how to achieve it. And Github seems to have an &#38;quot;afficial&#38;quot; support
for Jekyll site that disables plugin scripts (understandably so).&#60;/p&#62;
&#60;p&#62;But having worked with git and make for all these years made me immune to all
the fanciness the Internet tries to sell.&#60;/p&#62;
&#60;p&#62;Here&#39;s my script for deploying a Jekyll project to Github pages:&#60;/p&#62;
&#60;pre&#62;&#60;code&#62;DEPLOY_PATH=/tmp/jekyll_deploy
build:
	jekyll build

deploy:
	git checkout -f gh-pages
	git clean -d -x -f
	git pull
	git checkout master
	jekyll build
	rm -rf ${DEPLOY_PATH}
	mkdir ${DEPLOY_PATH}
	cp -R .git ${DEPLOY_PATH}
	cd ${DEPLOY_PATH}; git checkout gh-pages; git clean -d -x -f
	cp -R _site/* ${DEPLOY_PATH}
	cd ${DEPLOY_PATH}; git add .; git commit -m &#38;quot;`curl whatthecommit.com/index.txt`&#38;quot;
	cd ${DEPLOY_PATH}; git push -f origin gh-pages
&#60;/code&#62;&#60;/pre&#62;
&#60;p&#62;Drop it into root of your Jekyll project, commit all changes (including the
&#60;code&#62;Makefile&#60;/code&#62;). And type &#60;code&#62;make deploy&#60;/code&#62;. BOOM, done.&#60;/p&#62;
&#60;p&#62;There are a couple of assumptions:&#60;/p&#62;
&#60;ul&#62;
&#60;li&#62;You build the site in the &#60;code&#62;_site&#60;/code&#62; folder&#60;/li&#62;
&#60;li&#62;You store Jekyll source on &#60;code&#62;master&#60;/code&#62; and have the &#60;code&#62;gh-pages&#60;/code&#62; branch up.&#60;/li&#62;
&#60;li&#62;You can build the site by running &#60;code&#62;jekyll build&#60;/code&#62;.&#60;/li&#62;
&#60;li&#62;You don&#39;t care about commit message on the deploy branch.&#60;/li&#62;
&#60;/ul&#62;
&#60;p&#62;I like it better than other methods because it does not require installing
additional software/scripts and there&#39;s no restriction on plugins.&#60;/p&#62;
</description>
                <pubDate>Sun, 15 May 2016 01:00:00 -0700</pubDate>
                <link>https://duan.ca/2016/05/15/deploy-jekyll-to-github/</link>
                <guid isPermaLink="true">https://duan.ca/2016/05/15/deploy-jekyll-to-github/</guid>
            </item>
            <item>
                <title>Generating Xcode Build Number From Git</title>
                <description>&#60;p&#62;The build version number in an Xcode project (CFBundleVersion in Info.plist)
must be a monotonically increasing string for each archive submitted to the
App Store. Neglection of this requirement will result in an error during the
binary upload. Some automation will help avoiding this issue.&#60;/p&#62;
&#60;p&#62;First, we want to generate this version number from our version (&#60;em&#62;duh&#60;/em&#62;)
control system (VCS) each time our target gets built. My VCS of choice is Git,
users of other systems just need to get a increasing number from their code
history. On a *nix system, this command will count the number of commits on
&#39;develop&#39; branch up until HEAD:&#60;/p&#62;
&#60;pre&#62;&#60;code&#62;    git rev-list develop | wc -l
&#60;/code&#62;&#60;/pre&#62;
&#60;p&#62;This is a very good candidate for our build number, for longer history
generally correlates to later builds.&#60;/p&#62;
&#60;p&#62;Next, we make Xcode automatically run this command and use its result as the
build number.&#60;/p&#62;
&#60;p&#62;Go to project navigator, select your build target under the project icon,
click &#60;em&#62;Build Phases&#60;/em&#62;, select &#60;em&#62;Editor→Add Build Phase→Add Run Script Build
Phase&#60;/em&#62; in the menu. Remove the content in editor of the new &#60;em&#62;Run Script&#60;/em&#62;
phase and replace it with:&#60;/p&#62;
&#60;pre&#62;&#60;code&#62;revnum=`git rev-list develop | wc -l`
echo &#38;quot;#define BUILD_NUMBER $revnum&#38;quot; &#38;gt; InfoPlist.h
touch InfoPlist.h
&#60;/code&#62;&#60;/pre&#62;
&#60;p&#62;Go to build settings, change value of &#60;em&#62;Preprocess Info.plist File&#60;/em&#62; to &#38;quot;YES&#38;quot;.
Add &#38;quot;InfoPlist.h&#38;quot; to &#60;em&#62;Info.plist Preprocessor Prefix File→release&#60;/em&#62;.&#60;/p&#62;
&#60;p&#62;We ask Xcode to run our command and save its result as a &#38;quot;#define&#38;quot; in a header
file when it builds the project. This is done so that we can replace the
&#38;quot;hardcoded&#38;quot; build number with the name of the constant:&#60;/p&#62;
&#60;p&#62;Open Info.plist, Double click the value of &#60;em&#62;Bundle Version&#60;/em&#62; and replace it with&#60;/p&#62;
&#60;pre&#62;&#60;code&#62;BUILD_NUMBER
&#60;/code&#62;&#60;/pre&#62;
&#60;p&#62;There&#39;s only one issue left: &#60;code&#62;BUILD_NUMBER&#60;/code&#62; is now saved in &#60;em&#62;InfoPlist.h&#60;/em&#62;. Its
value comes from our commit history. So we want to exclude this piece of
information as part of our commit history (I&#39;ll leave the reason as an exercise
for the reader). Ignore this file by adding &#38;quot;InfoPlist.h&#38;quot; to &#60;em&#62;.gitignore&#60;/em&#62; (or
that of your other VCS).&#60;/p&#62;
&#60;p&#62;To recap, when you build the project now, Xcode will find out how many commits
are in the history, define it in a header file as &#60;code&#62;BUILD_NUMBER&#60;/code&#62;, which gets
used as the build number. As long as you keep with with version control, the
build number problem goes away.&#60;/p&#62;
</description>
                <pubDate>Sun, 29 Sep 2013 15:50:50 -0600</pubDate>
                <link>https://duan.ca/2013/09/29/generating-xcode-build-number-from-git/</link>
                <guid isPermaLink="true">https://duan.ca/2013/09/29/generating-xcode-build-number-from-git/</guid>
            </item>
            <item>
                <title>Keep Git Social</title>
                <description>&#60;p&#62;&#60;em&#62;A project I&#39;m working on uses &#60;a href=&#34;http://about.gitlab.com&#34;&#62;GitlabHQ&#60;/a&#62;, I think it is a cool open source
project and the developers are doing an excellent job of making a sweet web
interface for Git projects. However, as I found out today, &#60;a href=&#34;https://github.com/gitlabhq/gitlabhq/issues/1298&#34; title=&#34;Gitlab Issue: Closed&#34;&#62;my one issue&#60;/a&#62;
with it was closed without fixing. And that&#39;s what finally propelled me to
writing this airticle.&#60;/em&#62;&#60;/p&#62;
&#60;p&#62;Do you know, the Linux kernel is broken by hundreds of commited patches
everyday?&#60;/p&#62;
&#60;p&#62;That, of course, is a trick question. Yes, &#60;em&#62;technically&#60;/em&#62;, hundreds (if not
thousands) of patches were commited to &#60;em&#62;a&#60;/em&#62; git repository of the Linux kernel
that isn&#39;t different in anyway from &#60;em&#62;the&#60;/em&#62; repository. What makes the
repository &#38;quot;conanical&#38;quot; is the fact that Linus Torvalds owns it. If the world
lost access to his hard drive because Linus was hit by a bus (I would never
wish this to happen) today, all the Linux community need to do is figure out
who is next BDFL. Then his/hers would become &#60;em&#62;the&#60;/em&#62; Linux repository.&#60;/p&#62;
&#60;p&#62;In other words, what makes the difference is purely social.&#60;/p&#62;
&#60;p&#62;&#60;strong&#62;Not trying to fit the social structure of a software project into a
repository is the biggest strength of git.&#60;/strong&#62; This is why I frown everytime
I see a discussion about locking down branches of a Git repository.&#60;/p&#62;
&#60;p&#62;Making developers &#38;quot;own&#38;quot; branches on a shared repository is a pratice
inheritated from the days of centralized version control. Git doesn&#39;t provide
built-in support for this, for good reasons.&#60;/p&#62;
&#60;p&#62;With Subversion, the ultimate goal of branch-wise access control is to keep
out
bad changes made by developers while give them the benefits of version
control, namely:&#60;/p&#62;
&#60;ol&#62;
&#60;li&#62;provide a backup of the change history&#60;/li&#62;
&#60;li&#62;let others to follow his/her progress so that they can contribute via
patches or collaborate if they have write access.&#60;/li&#62;
&#60;/ol&#62;
&#60;p&#62;With Git, these are easily achieved by a personal repository read-accessible
for the team.&#60;/p&#62;
&#60;p&#62;Meanwhile, write access is granted at the repository level, but only to very
few or, more preferably, one person. This is possible because each team member
can have and only push to his/her own repositories. No change made by others
will make their way to the &#38;quot;conanical&#38;quot; repository unless its owner(s) activaly
pulls them in. Bad changes therefore is kept out.&#60;/p&#62;
&#60;p&#62;Additionally, Git has &#60;a href=&#34;http://git-scm.com/book/en/Git-Branching&#34;&#62;features&#60;/a&#62; flexible enough to support all kinds of
&#60;a href=&#34;http://nvie.com/posts/a-successful-git-branching-model&#34;&#62;development process&#60;/a&#62;es, partially because its branches, by design, are not
responsible for enforcing access permissions.&#60;/p&#62;
&#60;p&#62;Consider developer John working on a shared git repository with locked
branches: where would he push his temporary branch to for backup, if he can
only write to &#60;code&#62;feature42&#60;/code&#62; and &#60;code&#62;johns_branch&#60;/code&#62;? How does he get
&#60;code&#62;emergency_bugfix_14159&#60;/code&#62; pair reviewed at 4am? If he uses his own repo for
those, does it mean he has to force the whole team to know about it?  How does
it affect work when a &#60;code&#62;git branch --all&#60;/code&#62; produces a phone book?&#60;/p&#62;
&#60;p&#62;Break Git&#39;s design gets you no where nice.&#60;/p&#62;
&#60;p&#62;And no, Git&#39;s social model doesn&#39;t add work to the owner of the &#38;quot;official&#38;quot;
repository. Afterall, Git was designed with he linux kernel in mind!  Linus
himself explains it the best (summary provided below):&#60;/p&#62;
&#60;div class=&#34;video-container&#34;&#62;
    &#60;iframe src=&#34;http://www.youtube.com/embed/4XpnKHJAok8&#34; frameborder=&#34;0&#34; allowfullscreen&#62;&#60;/iframe&#62;
&#60;/div&#62;
&#60;p&#62;In short, Linus only review pull requests from a few &#38;quot;lieutenants&#38;quot; he trusts,
and they each follow the same process with their trusted few.  And the pyramid
trickles all the way down. Here agian, Git solves a problem by getting out of
the way of the project&#39;s social stucture, instead of trying to encapsulate it.&#60;/p&#62;
&#60;p&#62;Git was the first version control system I&#39;ve ever used starting in 2008.
I&#39;ve since gradually realized that not everyone is lucky like me, in the sense
that svn has been working just fine for a lot of people. When their project
switches to Git, emulating the svn/old workflow with functionality provided by
projects like &#60;code&#62;gitolite&#60;/code&#62; is only natural. But if you are one of them, and want
more creativity from your team, perhaps embracing the social aspect of Git by
breaking the shackles on their hand is a good thing to try.&#60;/p&#62;
</description>
                <pubDate>Wed, 31 Oct 2012 10:02:30 -0600</pubDate>
                <link>https://duan.ca/2012/10/31/keep-git-social/</link>
                <guid isPermaLink="true">https://duan.ca/2012/10/31/keep-git-social/</guid>
            </item>
    </channel>
</rss>